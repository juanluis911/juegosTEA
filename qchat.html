<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Q-CHAT - Cuestionario de Detecci√≥n del Autismo | JuegoTEA</title>
    
    <!-- Meta tags para SEO y accesibilidad -->
    <meta name="description" content="Cuestionario Q-CHAT para la detecci√≥n temprana del Trastorno del Espectro Autista (TEA) en ni√±os de 2-17 a√±os">
    <meta name="keywords" content="autismo, TEA, detecci√≥n temprana, Q-CHAT, cuestionario, desarrollo infantil">
    <meta name="author" content="JuegoTEA">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Q-CHAT - Cuestionario de Detecci√≥n del Autismo">
    <meta property="og:description" content="Herramienta de detecci√≥n temprana para el Trastorno del Espectro Autista">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="es_ES">
    
    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="../favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
    
    <!-- PWA -->
    <link rel="manifest" href="../manifest.json">
    <meta name="theme-color" content="#4299e1">
    
    <!-- Preload cr√≠tico -->
    <link rel="preload" href="./data/qchat-data.json" as="fetch" crossorigin="anonymous">
    
    <!-- Estilos CSS -->
    <link rel="stylesheet" href="./css/qchat-quiz.css">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "MedicalWebPage",
        "name": "Q-CHAT - Cuestionario de Detecci√≥n del Autismo",
        "description": "Cuestionario de detecci√≥n temprana para el Trastorno del Espectro Autista",
        "medicalAudience": "Patient",
        "about": {
            "@type": "MedicalCondition",
            "name": "Trastorno del Espectro Autista",
            "alternateName": "TEA"
        },
        "publisher": {
            "@type": "Organization",
            "name": "JuegoTEA"
        }
    }
    </script>
</head>

<body>
    <!-- Skip link para accesibilidad -->
    <a href="#main-content" class="skip-link">Saltar al contenido principal</a>

    <!-- Header -->
    <header class="header" role="banner">
        <nav class="nav-container" role="navigation" aria-label="Navegaci√≥n principal">
            <div class="logo">
                üìã Q-CHAT
            </div>
            <a href="../index.html" class="back-btn" aria-label="Volver a la p√°gina principal">
                ‚Üê Volver al Inicio
            </a>
        </nav>
    </header>

    <!-- Loading Overlay -->
    <div class="loading" id="loadingOverlay" role="status" aria-label="Cargando cuestionario">
        <div class="spinner" aria-hidden="true"></div>
        <span class="sr-only">Cargando...</span>
    </div>

    <!-- Main Content -->
    <main class="main-container" id="main-content" role="main">
        <div id="qchat-container" aria-live="polite" aria-atomic="true">
            <!-- Contenido inicial mientras carga -->
            <div class="loading-placeholder" style="text-align: center; padding: 3rem;">
                <div class="spinner"></div>
                <p style="margin-top: 1rem; color: var(--text-secondary);">
                    Cargando cuestionario...
                </p>
            </div>
        </div>
    </main>

    <!-- Scripts -->
    <script>
        // Configuraci√≥n global y datos del cuestionario
        window.QChatConfig = {
            dataUrl: './data/qchat-data.json',
            debug: false,
            enableAnalytics: false,
            version: '2.0'
        };

        // Datos completos del cuestionario (normalmente vendr√≠a del JSON)
        window.QChatData = {
            "metadata": {
                "version": "2.0",
                "title": "Q-CHAT - Cuestionario de Detecci√≥n del Autismo",
                "description": "Cuestionario de detecci√≥n temprana para el Trastorno del Espectro Autista (TEA) adaptado para diferentes rangos de edad",
                "authors": "JuegoTEA - Adaptado de Allison et al.",
                "language": "es",
                "lastUpdated": "2025-01-25"
            },
            "ageGroups": {
                "toddlers": {
                    "id": "toddlers",
                    "name": "Ni√±os Peque√±os",
                    "ageRange": "2-6 a√±os",
                    "minAge": 24,
                    "maxAge": 72,
                    "description": "Cuestionario adaptado para la primera infancia",
                    "totalQuestions": 25,
                    "completionTime": "5-7 minutos",
                    "scoringThreshold": {
                        "lowRisk": { "min": 0, "max": 3 },
                        "moderateRisk": { "min": 4, "max": 7 },
                        "highRisk": { "min": 8, "max": 25 }
                    }
                },
                "children": {
                    "id": "children",
                    "name": "Ni√±os Escolares",
                    "ageRange": "7-11 a√±os",
                    "minAge": 84,
                    "maxAge": 132,
                    "description": "Cuestionario adaptado para edad escolar temprana",
                    "totalQuestions": 30,
                    "completionTime": "8-10 minutos",
                    "scoringThreshold": {
                        "lowRisk": { "min": 0, "max": 4 },
                        "moderateRisk": { "min": 5, "max": 9 },
                        "highRisk": { "min": 10, "max": 30 }
                    }
                },
                "adolescents": {
                    "id": "adolescents",
                    "name": "Adolescentes",
                    "ageRange": "12-17 a√±os",
                    "minAge": 144,
                    "maxAge": 204,
                    "description": "Cuestionario adaptado para adolescentes",
                    "totalQuestions": 35,
                    "completionTime": "10-12 minutos",
                    "scoringThreshold": {
                        "lowRisk": { "min": 0, "max": 5 },
                        "moderateRisk": { "min": 6, "max": 12 },
                        "highRisk": { "min": 13, "max": 35 }
                    }
                }
            },
            "questions": {
                "toddlers": [
                    {
                        "id": 1,
                        "text": "¬øSu hijo/a le mira cuando le habla?",
                        "category": "social",
                        "subcategory": "eye_contact",
                        "options": [
                            { "value": 0, "text": "Siempre", "description": "Mi hijo/a siempre me mira cuando le hablo" },
                            { "value": 0, "text": "Casi siempre", "description": "Mi hijo/a me mira la mayor√≠a de las veces" },
                            { "value": 0, "text": "A veces", "description": "Mi hijo/a me mira algunas veces" },
                            { "value": 1, "text": "Raramente", "description": "Mi hijo/a raramente me mira cuando le hablo" },
                            { "value": 1, "text": "Nunca", "description": "Mi hijo/a nunca me mira cuando le hablo" }
                        ]
                    },
                    {
                        "id": 2,
                        "text": "¬øQu√© tan f√°cil es para usted hacer contacto visual con su hijo/a?",
                        "category": "social",
                        "subcategory": "eye_contact",
                        "options": [
                            { "value": 0, "text": "Muy f√°cil", "description": "Es muy f√°cil establecer contacto visual" },
                            { "value": 0, "text": "Bastante f√°cil", "description": "Generalmente es f√°cil hacer contacto visual" },
                            { "value": 0, "text": "Bastante dif√≠cil", "description": "A veces es dif√≠cil hacer contacto visual" },
                            { "value": 1, "text": "Muy dif√≠cil", "description": "Es muy dif√≠cil establecer contacto visual" },
                            { "value": 1, "text": "Imposible", "description": "No logro hacer contacto visual con mi hijo/a" }
                        ]
                    },
                    {
                        "id": 3,
                        "text": "¬øSu hijo/a se√±ala para pedir algo (por ejemplo, un juguete que est√° fuera de su alcance)?",
                        "category": "communication",
                        "subcategory": "pointing",
                        "options": [
                            { "value": 0, "text": "Muchas veces al d√≠a", "description": "Se√±ala frecuentemente para pedir cosas" },
                            { "value": 0, "text": "Algunas veces al d√≠a", "description": "Se√±ala ocasionalmente durante el d√≠a" },
                            { "value": 0, "text": "Algunas veces por semana", "description": "Se√±ala unas pocas veces por semana" },
                            { "value": 1, "text": "Menos de una vez por semana", "description": "Raramente se√±ala para pedir" },
                            { "value": 1, "text": "Nunca", "description": "Nunca se√±ala para pedir algo" }
                        ]
                    },
                    {
                        "id": 4,
                        "text": "¬øSu hijo/a se√±ala para mostrarle algo interessante?",
                        "category": "communication",
                        "subcategory": "joint_attention",
                        "options": [
                            { "value": 0, "text": "Muchas veces al d√≠a", "description": "Se√±ala frecuentemente para mostrar cosas" },
                            { "value": 0, "text": "Algunas veces al d√≠a", "description": "Ocasionalmente se√±ala para mostrar" },
                            { "value": 0, "text": "Algunas veces por semana", "description": "Se√±ala para mostrar pocas veces por semana" },
                            { "value": 1, "text": "Menos de una vez por semana", "description": "Raramente se√±ala para mostrar" },
                            { "value": 1, "text": "Nunca", "description": "Nunca se√±ala para mostrar algo" }
                        ]
                    },
                    {
                        "id": 5,
                        "text": "¬øSu hijo/a pretende (por ejemplo, hacer t√©, hablar por tel√©fono)?",
                        "category": "play",
                        "subcategory": "pretend_play",
                        "options": [
                            { "value": 0, "text": "Muchas veces al d√≠a", "description": "Juega imaginativamente con frecuencia" },
                            { "value": 0, "text": "Algunas veces al d√≠a", "description": "Ocasionalmente hace juego de pretensi√≥n" },
                            { "value": 0, "text": "Algunas veces por semana", "description": "Juego imaginativo pocas veces por semana" },
                            { "value": 1, "text": "Menos de una vez por semana", "description": "Raramente hace juego de pretensi√≥n" },
                            { "value": 1, "text": "Nunca", "description": "Nunca juega imaginativamente" }
                        ]
                    }
                ],
                "children": [
                    {
                        "id": 1,
                        "text": "¬øSu hijo/a mantiene conversaciones apropiadas para su edad?",
                        "category": "communication",
                        "subcategory": "conversation",
                        "options": [
                            { "value": 0, "text": "Siempre", "description": "Mantiene conversaciones fluidas y apropiadas" },
                            { "value": 0, "text": "Casi siempre", "description": "Generalmente conversa apropiadamente" },
                            { "value": 1, "text": "A veces", "description": "A veces tiene dificultades conversacionales" },
                            { "value": 1, "text": "Raramente", "description": "Raramente mantiene conversaciones apropiadas" },
                            { "value": 1, "text": "Nunca", "description": "No mantiene conversaciones apropiadas" }
                        ]
                    },
                    {
                        "id": 2,
                        "text": "¬øSu hijo/a entiende las expresiones faciales y el lenguaje corporal de otros?",
                        "category": "social",
                        "subcategory": "nonverbal_communication",
                        "options": [
                            { "value": 0, "text": "Muy bien", "description": "Comprende claramente las expresiones y gestos" },
                            { "value": 0, "text": "Bastante bien", "description": "Generalmente entiende las se√±ales no verbales" },
                            { "value": 1, "text": "Con dificultad", "description": "Tiene dificultades para interpretar expresiones" },
                            { "value": 1, "text": "Muy poco", "description": "Apenas comprende las se√±ales no verbales" },
                            { "value": 1, "text": "No entiende", "description": "No comprende expresiones ni gestos" }
                        ]
                    }
                ],
                "adolescents": [
                    {
                        "id": 1,
                        "text": "¬øSu hijo/a comprende las normas sociales no escritas en diferentes situaciones?",
                        "category": "social",
                        "subcategory": "social_norms",
                        "options": [
                            { "value": 0, "text": "Completamente", "description": "Comprende y aplica las normas sociales apropiadamente" },
                            { "value": 0, "text": "Bastante bien", "description": "Generalmente comprende las expectativas sociales" },
                            { "value": 1, "text": "Con ayuda", "description": "Necesita orientaci√≥n para entender normas sociales" },
                            { "value": 1, "text": "Con mucha dificultad", "description": "Tiene grandes dificultades con las normas sociales" },
                            { "value": 1, "text": "No las comprende", "description": "No comprende las expectativas sociales impl√≠citas" }
                        ]
                    },
                    {
                        "id": 2,
                        "text": "¬øSu hijo/a maneja bien los cambios en rutinas o planes?",
                        "category": "behavioral",
                        "subcategory": "flexibility",
                        "options": [
                            { "value": 0, "text": "Muy bien", "description": "Se adapta f√°cilmente a los cambios" },
                            { "value": 0, "text": "Bastante bien", "description": "Generalmente acepta los cambios sin problema" },
                            { "value": 1, "text": "Con dificultad", "description": "Le cuesta adaptarse a los cambios" },
                            { "value": 1, "text": "Muy mal", "description": "Los cambios le causan mucho estr√©s" },
                            { "value": 1, "text": "Extremadamente mal", "description": "No puede tolerar cambios en rutinas" }
                        ]
                    }
                ]
            },
            "categories": {
                "social": {
                    "name": "Interacci√≥n Social",
                    "description": "Habilidades de comunicaci√≥n social, contacto visual y relaciones interpersonales",
                    "icon": "üë•",
                    "color": "#4299e1"
                },
                "communication": {
                    "name": "Comunicaci√≥n",
                    "description": "Lenguaje verbal y no verbal, comprensi√≥n y expresi√≥n",
                    "icon": "üí¨",
                    "color": "#48bb78"
                },
                "play": {
                    "name": "Juego",
                    "description": "Juego imaginativo, creativo y uso apropiado de juguetes",
                    "icon": "üé≠",
                    "color": "#ed8936"
                },
                "behavioral": {
                    "name": "Comportamiento",
                    "description": "Rutinas, flexibilidad, movimientos repetitivos y adaptabilidad",
                    "icon": "üîÑ",
                    "color": "#9f7aea"
                },
                "sensory": {
                    "name": "Procesamiento Sensorial",
                    "description": "Sensibilidades auditivas, visuales, t√°ctiles y procesamiento sensorial",
                    "icon": "üëÇ",
                    "color": "#38b2ac"
                },
                "cognitive": {
                    "name": "Habilidades Cognitivas",
                    "description": "Atenci√≥n, memoria, resoluci√≥n de problemas y funciones ejecutivas",
                    "icon": "üß†",
                    "color": "#e53e3e"
                }
            },
            "scoring": {
                "interpretation": {
                    "lowRisk": {
                        "title": "Desarrollo T√≠pico",
                        "description": "Las respuestas sugieren un desarrollo dentro del rango esperado para la edad.",
                        "color": "#48bb78",
                        "icon": "‚úÖ",
                        "recommendations": [
                            "Continue fomentando el desarrollo a trav√©s del juego y la interacci√≥n",
                            "Mantenga las visitas regulares al pediatra",
                            "Contin√∫e observando el desarrollo de su hijo/a"
                        ]
                    },
                    "moderateRisk": {
                        "title": "Requiere Atenci√≥n",
                        "description": "Algunas respuestas sugieren la necesidad de evaluaci√≥n adicional.",
                        "color": "#ed8936",
                        "icon": "‚ö†Ô∏è",
                        "recommendations": [
                            "Consulte con el pediatra de su hijo/a",
                            "Considere una evaluaci√≥n del desarrollo",
                            "Documente comportamientos espec√≠ficos",
                            "Busque recursos de apoyo temprano"
                        ]
                    },
                    "highRisk": {
                        "title": "Evaluaci√≥n Recomendada",
                        "description": "Las respuestas indican la necesidad de evaluaci√≥n profesional especializada.",
                        "color": "#e53e3e",
                        "icon": "üö®",
                        "recommendations": [
                            "Busque evaluaci√≥n profesional inmediata",
                            "Contacte servicios de intervenci√≥n temprana",
                            "Documente comportamientos y situaciones espec√≠ficas",
                            "Considere servicios de apoyo para la familia"
                        ]
                    }
                }
            }
        };

        // Gesti√≥n de errores global
        window.addEventListener('error', function(e) {
            console.error('Error en Q-CHAT:', e.error);
            const container = document.getElementById('qchat-container');
            if (container) {
                container.innerHTML = `
                    <div class="error-container">
                        <div class="error-icon">‚ùå</div>
                        <h2>Error de Carga</h2>
                        <p>No se pudo cargar el cuestionario. Por favor, recarga la p√°gina.</p>
                        <button class="btn btn-primary" onclick="location.reload()">
                            üîÑ Recargar P√°gina
                        </button>
                    </div>
                `;
            }
        });

        // Gesti√≥n del estado de carga
        function showLoading() {
            const overlay = document.getElementById('loadingOverlay');
            if (overlay) {
                overlay.classList.add('show');
            }
        }

        function hideLoading() {
            const overlay = document.getElementById('loadingOverlay');
            if (overlay) {
                overlay.classList.remove('show');
            }
        }

        // Inicializaci√≥n cuando el DOM est√© listo
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üìã Q-CHAT DOM loaded');
            
            // Simular carga inicial
            showLoading();
            
            setTimeout(() => {
                hideLoading();
                // El QChatAssessment se inicializar√° autom√°ticamente
            }, 1000);
        });

        // Service Worker para PWA (opcional)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('../sw.js')
                    .then(function(registration) {
                        console.log('SW registrado con √©xito:', registration.scope);
                    })
                    .catch(function(error) {
                        console.log('SW fall√≥ al registrarse:', error);
                    });
            });
        }
    </script>

    <!-- Cargar el JavaScript principal -->
    <script src="./js/qchat-optimized.js"></script>

    <!-- Analytics (opcional) -->
    <script>
        // Analytics an√≥nimo para mejorar el cuestionario
        function trackEvent(category, action, label) {
            if (window.QChatConfig && window.QChatConfig.enableAnalytics) {
                // Implementar tracking an√≥nimo aqu√≠
                console.log('Analytics:', { category, action, label });
            }
        }

        // Trackear inicio del cuestionario
        document.addEventListener('DOMContentLoaded', function() {
            trackEvent('Q-CHAT', 'page_load', 'cuestionario_iniciado');
        });
    </script>

    <!-- S√≠ntesis de voz (opcional para accesibilidad) -->
    <script>
        // Funcionalidad de texto a voz para mejorar accesibilidad
        function speakText(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'es-ES';
                utterance.rate = 0.8;
                utterance.volume = 0.7;
                speechSynthesis.speak(utterance);
            }
        }

        // Agregar botones de audio a las preguntas (se puede implementar m√°s tarde)
        function addAudioSupport() {
            // Esta funci√≥n se puede expandir para agregar botones de audio
            // a cada pregunta para mayor accesibilidad
        }
    </script>
</body>
</html>